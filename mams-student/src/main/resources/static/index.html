<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>login</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        body {
            background-color: #3c3f41;
            opacity: 0.8;
        }

        #index {
            margin: 45px auto;
            width: 100%;
            height: auto;
            display: block;
        }

        .info {
            width: 40%;
            height: auto;
            margin: 0 auto;

        }

        .info > .nav {
            width: 100%;
            height: 40px;
            font-size: 20px;
            line-height: 40px;
            /*text-decoration: red;*/
        }

        .nav > label {
            width: 100px;
            height: 20px;
            z-index: 10;
            border-bottom: 2px solid transparent;
        }

        .nav > label > a {
            font-style: normal;
            text-decoration: none;
            border-collapse: collapse;
            color: white;
        }

        /*.nav > label > a[id='signUpNav'] {*/
        /*    font-style: normal;*/
        /*    text-decoration: none;*/
        /*    border-collapse: collapse;*/
        /*    color: blue;*/
        /*}*/
        .nav > label > a[id="signUpNav"] {
            color: blue;
        }

        .tittle {
            width: 100%;
            height: 45px;
            padding-left: 5px;
            font-size: 25px;
            line-height: 45px;
        }

        .info > .msg {
            width: 100%;
            height: auto;
        }

        .msg > .tips {
            font-style: normal;
            width: 100px;
            height: 15px;
            color: #ff8346;
            font-size: 15px;
            line-height: 15px;
        }

        .msg > input {
            font-style: normal;
            padding-left: 5px;
            width: 60%;
            height: 35px;
            border-collapse: collapse;
            font-size: 20px;
            line-height: 20px;
            display: block;
            border-radius: 5px;
            border: none;
            outline: none;
        }
    </style>
</head>
<body>

<script src="js/vueresource/vuejs-2.5.16.js"></script>
<script src="js/vueresource/axios-0.18.0.js"></script>
<div class="tittle">硕士招生管理系学生端</div>
<div id="index">
    <div class="info">
        <div class="nav">
            <label><a @click="registerPage" id="signUpNav">注册</a></label>
            <label><a @click="loginPage" id="signInNav">登录</a></label>
        </div>
        <div class="msg" v-if="signUp">
            <lable class="tips">请输入邮箱</lable>
            <input id="signInEmail" placeholder="email" type="text"/>
            <lable class="tips">请输入密码</lable>
            <input id="signInPassword" placeholder="password" type="password"/>
            <lable class="tips">请输入验证码...</lable>
            <input id="signInCheckCode" placeholder="check code" type="text">
            <lable>&nbsp</lable>
            <input @click="signInSendCheckCode" type="button" value="点击发送验证码">
            <lable>&nbsp</lable>
            <input @click="login" id="signInPage" type="button" value="点击登录">
        </div>
        <div class="msg" v-else>
            <lable class="tips">请设置用户名</lable>
            <input id="signUpUsername" placeholder="username" type="text"/>
            <lable class="tips">请设置密码</lable>
            <input id="signUpPassword" placeholder="password" type="password"/>
            <lable>本人邮箱地址</lable>
            <input id="signUpEmail" placeholder="email" type="email">
            <lable class="tips">请输入验证码...</lable>
            <input id="signUpCheckCode" placeholder="check code" type="text">
            <lable>&nbsp</lable>
            <input @click="signUpSendCheckCode" type="button" value="点击发送验证码">
            <lable>&nbsp</lable>
            <input @click="register" id="signUpPage" type="button" value="点击注册">
        </div>
        <span><label><a href="">联系客服</a></label></span>
    </div>
</div>

<script>
    var index = new Vue({
            el: "#index",
            data: {
                signUp: false,
                studentRealNameInfo: {},
                checkCode: null,
                responseCheckCode: ""
            },
            methods: {
                registerPage: function () {
                    document.getElementById("signUpNav").style.color = "blue";
                    document.getElementById("signInNav").style.color = "white";
                    this.signUp = false

                },
                loginPage: function () {
                    document.getElementById("signInNav").style.color = "blue";
                    document.getElementById("signUpNav").style.color = "white";
                    this.signUp = true

                },
                sigInData: function () {
                    var isEmai = false;
                    var userName = document.getElementById("signInUsername").value;
                    if (userName.endsWith("@qq.com"))
                        isEmai = true;
                    var password = document.getElementById("signInPassword").value;
                    var signUpCheckCode = document.getElementById("signUpCheckCode").value;
                    this.checkCode = signUpCheckCode;
                    if (isEmai)
                        this.studentRealNameInfo = {email: userName, password: password};
                    else
                        this.studentRealNameInfo = {userName: userName, password: password};
                },
                sigUpData: function () {
                    var signUpUsername = document.getElementById("signUpUsername").value;
                    var signUpPassword = document.getElementById("signUpPassword").value;
                    var signUpEmail = document.getElementById("signUpEmail").value;
                    var signUpCheckCode = document.getElementById("signUpCheckCode").value;
                    this.checkCode = signUpCheckCode;

                    this.studentRealNameInfo = {
                        userName: signUpUsername,
                        password: signUpPassword,
                        email: signUpEmail
                    };

                },
                sigInData: function () {
                    var signInUsername = document.getElementById("signInEmail").value;
                    var signInPassword = document.getElementById("signInPassword").value;
                    var signInCheckCode = document.getElementById("signInCheckCode").value;
                    this.checkCode = signInCheckCode;
                    this.studentRealNameInfo = {
                        email: signInUsername,
                        password: signInPassword,
                    };

                },
                register: function () {
                    if (!this.signUp) {
                        this.sigUpData();
                        console.log(this.studentRealNameInfo);
                        axios({
                            method: 'post',
                            url: '/student/register',
                            dataType: "json",
                            data: this.studentRealNameInfo,
                        }).then((value) => {
                            console.log(value.value)
                        });
                    }
                },
                signUpSendCheckCode: function () {
                    if (!this.signUp) {
                        this.sigUpData();
                        console.log(this.studentRealNameInfo);
                        axios({
                            method: 'post',
                            url: '/student/sendCheckCode',
                            dataType: "json",
                            data: this.studentRealNameInfo,

                        }).then((data) => {
                            console.log(data.value)
                        });
                    }
                },
                signInSendCheckCode: function () {
                    if (this.signUp) {
                        this.sigInData();

                        axios({
                            method: 'post',
                            url: '/student/sendCheckCode',
                            dataType: "json",
                            data: this.studentRealNameInfo,
                        }).then((data) => {
                            this.responseCheckCode = data.data.value;
                            console.log(this.responseCheckCode)
                        });
                    }
                },
                login: function () {
                    this.sigInData();
                    console.log(this.checkCode);
                    console.log(this.responseCheckCode);
                    if (this.studentRealNameInfo === "") {
                        alert("用户名不能为空");
                        return;
                    }
                    if (this.studentRealNameInfo.password == "") {
                        alert("密码为空");
                        return;
                    }
                    if (!this.checkCode == this.responseCheckCode) {
                        alert("验证码错误");
                        return;
                    }
                    axios({
                        method: 'post',
                        url: '/student/login',
                        dataType: "json",
                        data: this.studentRealNameInfo,

                    }).then((data) => {
                        localStorage.setItem('student', JSON.stringify(data.data.value))
                        console.log(localStorage.getItem('student'));
                    })
                    window.location=""

                }

            }
        }
    )
</script>
</body>
</html>